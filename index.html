<html lang="en"
  ><head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="A fully featured admin theme which can be used to build CRM, CMS, etc."
    />

    <!-- Favicon -->
    <link
      rel="shortcut icon"
      href="assets/favicon/favicon.ico"
      type="image/x-icon"
    />

    <!-- Map CSS -->
    <link
      rel="stylesheet"
      href="https://api.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css"
    />

    <!-- Libs CSS -->
    <link rel="stylesheet" href="assets/css/libs.bundle.css" />

    <!-- Theme CSS -->
    <link
      rel="stylesheet"
      href="assets/css/theme.bundle.css"
      id="stylesheetLight"
    />
    <link
      rel="stylesheet"
      href="assets/css/theme-dark.bundle.css"
      id="stylesheetDark"
      disabled=""
    />

    <style>
      body {
        display: none;
      }
    </style>

    <!-- Title -->
    <title>Tomobila</title>
  </head>
  <body
    class="d-flex align-items-center bg-auth border-top border-top-2 border-primary"
    style="display: block"
  >
    <!-- CONTENT
    ================================================== -->
    <div class="container-fluid">
      <div class="row justify-content-center">
        <div
          class="col-12 col-md-5 col-lg-6 col-xl-4 px-lg-6 my-5 align-self-center"
        >
          <!-- Heading -->
          <h1 class="display-4 text-center mb-3"> Sign up </h1>

          <!-- Subheading -->
          <p class="text-muted text-center mb-5">
            Free access to our dashboard.
          </p>

          <!-- Form -->
          <form onsubmit="login(event)">
            <!-- Email address -->
            <div class="form-group">
              <!-- Label -->
              <label class="form-label"> Email Address </label>

              <!-- Input -->
              <input
                type="email"
                class="form-control"
                placeholder="name@address.com"
                id="username"
              />
            </div>

            <!-- Password -->
            <div class="form-group">
              <!-- Label -->
              <label class="form-label"> Password </label>

              <!-- Input group -->
              <div class="input-group input-group-merge">
                <!-- Input -->
                <input
                  class="form-control"
                  type="password"
                  autocomplete
                  placeholder="Enter your password"
                  id="password"
                />

                <!-- Icon -->
                <span class="input-group-text">
                  <i class="fe fe-eye"></i>
                </span>
              </div>
            </div>

            <!-- Submit -->
            <button type="submit" class="btn btn-lg w-100 btn-primary mb-3">
              Sign up
            </button>

            <!-- Link -->
            <div class="text-center">
              <small class="text-muted text-center">
                Already have an account?
                <a href="sign-in-cover.html">Log in</a>.
              </small>
            </div>
          </form>
        </div>
        <div class="col-12 col-md-7 col-lg-6 col-xl-8 d-none d-lg-block">
          <!-- Image -->
          <div
            class="bg-cover h-100 min-vh-100 mt-n1 me-n3"
            style="background-image: url('assets/img/offer.png')"
          ></div>
        </div>
      </div>
      <!-- / .row -->
    </div>

    <!-- JAVASCRIPT -->

    <!-- Vendor JS -->
    <script src="assets/js/vendor.bundle.js"></script>

    <!-- Theme JS -->
    <script src="assets/js/theme.bundle.js"></script>
    <script>
      async function login(event) {
        event.preventDefault(); // Prevent form from submitting the traditional way
        console.log("dsdsdsds");

        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;

        // API URL for login
        const apiUrl = "https://panel.tomobila.com/api/auth/local"; // Replace with your API URL

        try {
          const response = await fetch(apiUrl, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              identifier: username,
              password: password,
            }),
          });

          if (!response.ok) {
            throw new Error("Login failed");
          }

          const data = await response.json();

          // Assuming the API returns a token
          const token = data.jwt;
          console.log(token);

          // Store the token (in localStorage or cookies)
          localStorage.setItem("authToken", token);
          console.log("okkk");

          // Redirect to the protected page
          window.location.href = "dashboard.html";
        } catch (error) {
          alert("Login failed. Please try again.");
        }
      }
    </script>
  </body>
</html>
